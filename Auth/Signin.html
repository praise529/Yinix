<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Links!!! ðŸ”— -->
    <link rel="stylesheet" href="../Index.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/bold/style.css" />

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - Yinix</title>
</head>
<body>
    <div class="Account_Form">
        <h1>Sign In</h1><br>
        
        <form method="post" id="Signin_Form">
            <label for="Signin_Code">Your Code</label>
            <input type="number" name="Signin_Code" id="Signin_Code" 
            maxlength="7" required placeholder="010023">
            <input type="email" name="Signin_Email" id="Signin_Email"
            maxlength="255" minlength="5" placeholder="Your Email (if you have one)..." autocapitalize="off">
            <input type="password" name="Signin_Code" id="Signin_Password"
            placeholder="You NEED this...">

            <button type="submit">Signin!</button>
        </form><br><br>

        <div class="Social_Buttons">
            <button class="OAuth2_Signin_Button" id="Google"><i class="ph-bold ph-google-logo"></i> Sign In With Google</button>
            <button class="OAuth2_Signin_Button" id="Apple"><i class="ph-bold ph-apple-logo"></i> Sign In With Apple</button>
        </div>
    </div>

    <script>
        const Signin_Form = document.getElementById("Signin_Form");
        const Signin_Code = document.getElementById("Signin_Code");
        const Signin_Email = document.getElementById("Signin_Email");
        const Signin_Password = document.getElementById("Signin_Password");

        Signin_Form.addEventListener("submit", async (Event) => {
            Event.preventDefault();
            Submit();
        })

        async function Submit() {
            fetch("http://localhost:1100/API/Auth/Sign_In", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ Code: Signin_Code.value, Email: Signin_Email.value, Password: Signin_Password.value })
            })
            .then((Json) => { return Json.json() })
            .then((Yinix_Data) => {
                console.log("YYYYYYYYAAAAAAAAAAAAAYYYYYYYYYYYY!!!!!!!");
                console.log(Yinix_Data);

                localStorage.setItem("Name", Yinix_Data.Info.Name);
                localStorage.setItem("Email", Yinix_Data.Info.Email);
                localStorage.setItem("Code", Yinix_Data.Info.Code);

                setTimeout(() => { document.location = "../index.html" }, 1000);
            })
            .catch((Err) => {
                console.error(`We couldn't sign you in because ${Err}`);
            })
            .finally(() => {
                console.info("Sign in complete");
            });
        }
    </script>
</body>
</html>